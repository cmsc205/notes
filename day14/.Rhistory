knn_df <- data.frame(grid_pts, class = knn_preds)
ggplot(data = ckd_norm) +
geom_point(data = knn_df, aes(x = hemo, y = bgr, color = class), alpha = 0.5) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
lims(x = c(-2, 2), y = c(-2, 2))
grid_pts <- expand.grid(hemo = seq(-2, 6, length.out = 40), wbcc = seq(-2, 6, length.out = 40))
knn_preds <- knn(train = ckd_train[,c(1,3)], test = grid_pts, cl = ckd_train[["class"]], k = 1)
knn_df <- data.frame(grid_pts, class = knn_preds)
ggplot(data = ckd_norm) +
geom_point(data = knn_df, aes(x = wbcc, y = bgr, color = class), alpha = 0.5) +
geom_point(aes(x = wbcc, y = bgr, fill = class), color = "black", pch = 21) +
labs(x = "White Blood Cell Count", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
lims(x = c(-2, 2), y = c(-2, 2))
knn_df <- data.frame(grid_pts, class = knn_preds)
ggplot(data = ckd_norm) +
geom_point(data = knn_df, aes(x = wbcc, y = bgr, color = class), alpha = 0.5) +
geom_point(aes(x = wbcc, y = bgr, fill = class), color = "black", pch = 21) +
labs(x = "White Blood Cell Count", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
lims(x = c(-2, 2), y = c(-2, 2))
knn_df
grid_pts <- expand.grid(bgr = seq(-2, 6, length.out = 40), wbcc = seq(-2, 6, length.out = 40))
knn_preds <- knn(train = ckd_train[,c(1,3)], test = grid_pts, cl = ckd_train[["class"]], k = 1)
knn_df <- data.frame(grid_pts, class = knn_preds)
knn_df
head(knn_df)
ggplot(data = knn_df) +
geom_point(aes(x = wbcc, y = bgr, color = class), alpha = 0.5) +
labs(x = "White Blood Cell Count", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
lims(x = c(-2, 2), y = c(-2, 2))
ggplot(data = knn_df) +
geom_point(aes(x = wbcc, y = bgr, color = class), alpha = 0.5) +
labs(x = "White Blood Cell Count", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE)
ckd_train[,c(1,3)]
knn_preds <- knn(train = ckd_train[,c(2,3)], test = grid_pts, cl = ckd_train[["class"]], k = 1)
knn_df <- data.frame(grid_pts, class = knn_preds)
ggplot(data = knn_df) +
geom_point(aes(x = wbcc, y = bgr, color = class), alpha = 0.5) +
labs(x = "White Blood Cell Count", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE)
grid_pts <- expand.grid(bgr = seq(-2, 6, length.out = 40), wbcc = seq(-2, 6, length.out = 40))
knn_preds <- knn(train = ckd_train[,c(2,3)], test = grid_pts, cl = ckd_train[["class"]], k = 3)
knn_df <- data.frame(grid_pts, class = knn_preds)
ggplot(data = knn_df) +
geom_point(aes(x = wbcc, y = bgr, color = class), alpha = 0.5) +
labs(x = "White Blood Cell Count", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE)
knn_decisions <-
ggplot(data = knn_df) +
geom_point(aes(x = wbcc, y = bgr, color = class), alpha = 0.5) +
labs(x = "White Blood Cell Count", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE)
knn_decisions +
geom_point(data = ckd_test, color = "black", pch = 21, alpha = 0.7)
ckd_test
knn_decisions +
geom_point(data = ckd_test, aes(x = wbcc, y = bgr), color = "black", pch = 21, alpha = 0.7)
knn_decisions +
geom_point(data = ckd_test, aes(x = wbcc, y = bgr, fill = class), color = "black", pch = 21, alpha = 0.7)
grid_pts <- expand.grid(bgr = seq(-2, 6, length.out = 40), wbcc = seq(-2, 6, length.out = 40))
knn_preds <- knn(train = ckd_train[,c(2,3)], test = grid_pts, cl = ckd_train[["class"]], k = 3)
knn_df <- data.frame(grid_pts, class = knn_preds)
knn_decisions <-
ggplot(data = knn_df) +
geom_point(aes(x = wbcc, y = bgr, color = class), alpha = 0.3) +
labs(x = "White Blood Cell Count", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE)
knn_decisions
knn_decisions +
geom_point(data = ckd_test, aes(x = wbcc, y = bgr, fill = class), color = "black", pch = 21, alpha = 0.7)
# Illustrating the decision boundary
knn_preds <- knn(train = ckd_norm[,1:2], test = grid_pts, cl = ckd_norm[["class"]], k = 1)
knn_df <- data.frame(grid_pts, class = knn_preds)
ggplot(data = ckd_norm) +
geom_point(data = knn_df, aes(x = hemo, y = bgr, color = class), alpha = 0.3) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
lims(x = c(-2, 2), y = c(-2, 2))
library(tidyverse)
library(viridis)
library(class)
normalize <- function(df) {
num_cols <- df %>%
select_if(is.numeric) %>%
purrr::map_df(function(x) as.numeric(scale(x)))
other_cols <- df %>%
select_if(function(x) !is.numeric(x))
cbind(num_cols, other_cols)
}
ckd <- read.csv("data/ckd.csv")
head(ckd)
ckd_norm <- normalize(ckd) %>%
select(hemo, bgr, wbcc, class)
head(ckd_norm)
ggplot(data = ckd_norm, aes(x = hemo, y = bgr, color = class)) +
geom_point() +
labs(x = "Hemoglobin", y = "Glucose") +
scale_color_viridis(discrete = TRUE)
# Many simulated values to classify
grid_pts <- expand.grid(hemo = seq(-2, 2, length.out = 40), bgr = seq(-2, 2, length.out = 40))
ggplot(data = ckd_norm) +
geom_point(data = grid_pts, aes(x = hemo, y = bgr), alpha = 0.5) +
geom_point(aes(x = hemo, y = bgr, color = class)) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
lims(x = c(-2, 2), y = c(-2, 2))
# Illustrating the decision boundary
knn_preds <- knn(train = ckd_norm[,1:2], test = grid_pts, cl = ckd_norm[["class"]], k = 1)
knn_df <- data.frame(grid_pts, class = knn_preds)
ggplot(data = ckd_norm) +
geom_point(data = knn_df, aes(x = hemo, y = bgr, color = class), alpha = 0.3) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
lims(x = c(-2, 2), y = c(-2, 2))
# Many simulated values to classify
grid_pts <- expand.grid(hemo = seq(-2, 2, length.out = 40), bgr = seq(-2, 2, length.out = 40))
ggplot(data = ckd_norm) +
geom_point(data = grid_pts, aes(x = hemo, y = bgr), alpha = 0.3) +
geom_point(aes(x = hemo, y = bgr, color = class)) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
lims(x = c(-2, 2), y = c(-2, 2))
ggplot(data = ckd_norm, aes(x = hemo, y = bgr, color = class)) +
geom_point(color = "black", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_color_viridis(discrete = TRUE)
ggplot(data = ckd_norm, aes(x = hemo, y = bgr, fill = class)) +
geom_point(color = "black", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_color_viridis(discrete = TRUE)
ggplot(data = ckd_norm, aes(x = hemo, y = bgr, fill = class)) +
geom_point(color = "black", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_fill_viridis(discrete = TRUE)
# Many simulated values to classify
grid_pts <- expand.grid(hemo = seq(-2, 2, length.out = 40), bgr = seq(-2, 2, length.out = 40))
ggplot(data = ckd_norm) +
geom_point(data = grid_pts, aes(x = hemo, y = bgr), alpha = 0.3) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_fill_viridis(discrete = TRUE) +
lims(x = c(-2, 2), y = c(-2, 2))
library(tidyverse)
library(viridis)
library(class)
# Function to normalize the numeric columns of a data frame
# requires the purrr package to be installed
normalize <- function(df) {
num_cols <- df %>%
select_if(is.numeric) %>%
purrr::map_df(function(x) as.numeric(scale(x)))
other_cols <- df %>%
select_if(function(x) !is.numeric(x))
cbind(num_cols, other_cols)
}
library(tidyverse)
library(viridis)
library(class)
# Function to normalize the numeric columns of a data frame
# requires the purrr package to be installed
normalize <- function(df) {
num_cols <- df %>%
select_if(is.numeric) %>%
purrr::map_df(function(x) as.numeric(scale(x)))
other_cols <- df %>%
select_if(function(x) !is.numeric(x))
cbind(num_cols, other_cols)
}
knn
library(tidyverse)
library(viridis)
library(class)
library(purrr)
ckd_norm <- normalize(ckd) %>%
select(hemo, bgr, wbcc, class)
head(ckd_norm)
ckd <- read.csv("data/ckd.csv")
head(ckd)
ggplot(data = ckd_norm, aes(x = hemo, y = bgr, fill = class)) +
geom_point(color = "black", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_fill_viridis(discrete = TRUE)
# Many simulated values to classify
grid_pts <- expand.grid(hemo = seq(-2, 2, length.out = 40), bgr = seq(-2, 2, length.out = 40))
ggplot(data = ckd_norm) +
geom_point(data = grid_pts, aes(x = hemo, y = bgr), alpha = 0.3) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_fill_viridis(discrete = TRUE) +
lims(x = c(-2, 2), y = c(-2, 2))
ggplot(data = ckd_norm) +
geom_point(data = grid_pts, aes(x = hemo, y = bgr), alpha = 0.3) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_fill_viridis(discrete = TRUE)
ggplot(data = ckd_norm) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_fill_viridis(discrete = TRUE)
ggplot(data = ckd_norm) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
geom_point(aes(x = 0, y = 1.5, fill = class), color = "red", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_fill_viridis(discrete = TRUE)
ggplot(data = ckd_norm) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
geom_point(aes(x = 0, y = 1.5), fill = "red", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_fill_viridis(discrete = TRUE)
scale_fill_viridis
viridis_pal
viridis
viridis_pal
viridis_pal()
viridis(n=3, alpha=1, begin=0, end=1, option="D")
ggplot(data = ckd_norm) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
geom_point(aes(x = 0, y = 1.5), fill = "#21908CFF", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_fill_viridis(discrete = TRUE)
ggplot(data = ckd_norm) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
geom_point(aes(x = 0, y = 1.5), fill = "#21908CFF") +
labs(x = "Hemoglobin", y = "Glucose") +
scale_fill_viridis(discrete = TRUE)
ggplot(data = ckd_norm) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
geom_point(aes(x = 0, y = 1.5), color = "red") +
labs(x = "Hemoglobin", y = "Glucose") +
scale_fill_viridis(discrete = TRUE)
ggplot(data = ckd_norm) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
geom_point(aes(x = 0, y = 1.5), color = "#21908CFF") +
labs(x = "Hemoglobin", y = "Glucose") +
scale_fill_viridis(discrete = TRUE)
ggplot(data = ckd_norm) +
geom_point(aes(x = hemo, y = bgr, color = class)) +
geom_point(aes(x = 0, y = 1.5), color = "#21908CFF") +
labs(x = "Hemoglobin", y = "Glucose") +
scale_color_viridis(discrete = TRUE)
ggplot(data = ckd_norm) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
geom_point(aes(x = 0, y = 1.5), color = "red") +
labs(x = "Hemoglobin", y = "Glucose") +
scale_fill_viridis(discrete = TRUE)
distance
dist_df <- rbind(c(hemo = 0, bgr = 1.5), ckd_norm) %>%
dist()
dist_df <- rbind(c(hemo = 0, bgr = 1.5), ckd_norm[[c("hemo", "bgr")]]) %>%
dist()
ckd_norm[[c("hemo", "bgr")]]
ckd_norm[c("hemo", "bgr")]
dist_df <- rbind(c(hemo = 0, bgr = 1.5), ckd_norm[c("hemo", "bgr")]) %>%
dist()
distr_df
dist_df
row.names(dist_df)[which.min(dist_df[,1])]
dist_df[,1]
str(dist_df)
dist_df <- rbind(c(hemo = 0, bgr = 1.5), ckd_norm[c("hemo", "bgr")]) %>%
dist() %>%
as.matrix()
View(dist_df)
which.min(dist_df[,1])
row.names(dist_df)[which.min(dist_df[,1])]
View(dist_df)
dist_df[-1,1]
which.min(dist_df[-1,1])
row.names(dist_df)[which.min(dist_df[-1,1])]
View(dist_df)
ggplot(data = ckd_norm) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
geom_point(aes(x = 0, y = 1.5), color = "red") +
labs(x = "Hemoglobin", y = "Glucose") +
scale_fill_viridis(discrete = TRUE)
# Illustrating the decision boundary
knn_preds <- knn(train = ckd_norm[,1:2], test = grid_pts, cl = ckd_norm[["class"]], k = 1)
knn_df <- data.frame(grid_pts, class = knn_preds)
ggplot(data = ckd_norm) +
geom_point(data = knn_df, aes(x = hemo, y = bgr, color = class), alpha = 0.3) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
lims(x = c(-2, 2), y = c(-2, 2))
# Illustrating the decision boundary
knn_preds <- knn(train = ckd_norm[,1:2], test = grid_pts, cl = ckd_norm[["class"]], k = 1)
knn_df <- data.frame(grid_pts, class = knn_preds)
ggplot(data = ckd_norm) +
geom_point(data = knn_df, aes(x = hemo, y = bgr, color = class), alpha = 0.3) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
lims(x = c(-2, 2), y = c(-2, 2)) +
theme_bw()
# Illustrating the decision boundary
knn_preds <- knn(train = ckd_norm[,1:2], test = grid_pts, cl = ckd_norm[["class"]], k = 1)
knn_df <- data.frame(grid_pts, class = knn_preds)
ggplot(data = ckd_norm) +
geom_point(data = knn_df, aes(x = hemo, y = bgr, color = class), alpha = 0.3) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
lims(x = c(-2, 2), y = c(-2, 2)) +
theme_minimal()
# Illustrating the decision boundary
knn_preds <- knn(train = ckd_norm[,1:2], test = grid_pts, cl = ckd_norm[["class"]], k = 1)
knn_df <- data.frame(grid_pts, class = knn_preds)
ggplot(data = ckd_norm) +
geom_point(data = knn_df, aes(x = hemo, y = bgr, color = class), alpha = 0.4) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE) +
lims(x = c(-2, 2), y = c(-2, 2)) +
theme_minimal()
ggplot(data = ckd_norm, aes(x = wbcc, y = bgr, fill = class)) +
geom_point(color = "black", pch = 21, alpha = 0.7) +
labs(x = "White blood cell count", y = "Glucose") +
scale_fill_viridis(discrete = TRUE)
grid_pts <- expand.grid(bgr = seq(-2, 6, length.out = 40), wbcc = seq(-2, 6, length.out = 40))
knn_preds <- knn(train = ckd_train[,c(2,3)], test = grid_pts, cl = ckd_train[["class"]], k = 3)
knn_df <- data.frame(grid_pts, class = knn_preds)
knn_decisions <-
ggplot(data = knn_df) +
geom_point(aes(x = wbcc, y = bgr, color = class), alpha = 0.3) +
labs(x = "White Blood Cell Count", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE)
knn_decisions
ggplot(data = knn_df) +
geom_point(aes(x = wbcc, y = bgr, color = class), alpha = 0.3) +
geom_point(data = ckd_norm, aes(x = wbcc, y = bgr, fill = class), color = "black", pch = 21, alpha = 0.7) +
labs(x = "White Blood Cell Count", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE)
grid_pts <- expand.grid(bgr = seq(-2, 6, length.out = 40), wbcc = seq(-2, 6, length.out = 40))
knn_preds <- knn(train = ckd_train[,c(2,3)], test = grid_pts, cl = ckd_train[["class"]], k = 3)
knn_df <- data.frame(grid_pts, class = knn_preds)
knn_decisions <-
ggplot(data = knn_df) +
geom_point(aes(x = wbcc, y = bgr, color = class), alpha = 0.3) +
geom_point(data = ckd_norm, aes(x = wbcc, y = bgr, fill = class), color = "black", pch = 21, alpha = 0.7) +
labs(x = "White Blood Cell Count", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE)
knn_decisions
grid_pts <- expand.grid(bgr = seq(-2, 6, length.out = 40), wbcc = seq(-2, 6, length.out = 40))
knn_preds <- knn(train = ckd_train[,c(2,3)], test = grid_pts, cl = ckd_train[["class"]], k = 3)
knn_df <- data.frame(grid_pts, class = knn_preds)
knn_decisions <-
ggplot(data = knn_df) +
geom_point(aes(x = wbcc, y = bgr, color = class), alpha = 0.3) +
geom_point(data = ckd_norm, aes(x = wbcc, y = bgr, fill = class), color = "black", pch = 21, alpha = 0.7) +
labs(x = "White Blood Cell Count", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE)
knn_decisions + theme_minimal()
grid_pts <- expand.grid(bgr = seq(-2, 6, length.out = 40), wbcc = seq(-2, 6, length.out = 40))
knn_preds <- knn(train = ckd_train[,c(2,3)], test = grid_pts, cl = ckd_train[["class"]], k = 3)
knn_df <- data.frame(grid_pts, class = knn_preds)
knn_decisions <-
ggplot(data = knn_df) +
geom_point(aes(x = wbcc, y = bgr, color = class), alpha = 0.4) +
geom_point(data = ckd_norm, aes(x = wbcc, y = bgr, fill = class), color = "black", pch = 21, alpha = 0.7) +
labs(x = "White Blood Cell Count", y = "Glucose") +
scale_color_viridis(discrete = TRUE) +
scale_fill_viridis(discrete = TRUE)
knn_decisions + theme_minimal()
ggplot(data = ckd_norm, aes(x = wbcc, y = bgr, fill = class)) +
geom_point(color = "black", pch = 21, alpha = 0.7) +
labs(x = "White blood cell count", y = "Glucose") +
scale_fill_viridis(discrete = TRUE) +
theme_minimal()
# Many simulated values to classify
grid_pts <- expand.grid(hemo = seq(-2, 2, length.out = 40), bgr = seq(-2, 2, length.out = 40))
ggplot(data = ckd_norm) +
geom_point(data = grid_pts, aes(x = hemo, y = bgr), alpha = 0.3) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_fill_viridis(discrete = TRUE) +
lims(x = c(-2, 2), y = c(-2, 2)) +
theme_minimal()
ggplot(data = ckd_norm) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
geom_point(aes(x = 0, y = 1.5), color = "red") +
labs(x = "Hemoglobin", y = "Glucose") +
scale_fill_viridis(discrete = TRUE) +
theme_minimal()
ggplot(data = ckd_norm) +
geom_point(aes(x = hemo, y = bgr, fill = class), color = "black", pch = 21) +
geom_point(aes(x = 0, y = 1.5), color = "red") +
labs(x = "Hemoglobin", y = "Glucose") +
scale_fill_viridis(discrete = TRUE) +
theme_minimal()
ggplot(data = ckd_norm, aes(x = hemo, y = bgr, fill = class)) +
geom_point(color = "black", pch = 21) +
labs(x = "Hemoglobin", y = "Glucose") +
scale_fill_viridis(discrete = TRUE) +
theme_minimal()
?set.seed
set.seed(2152017)
train_index <- sample(nrow(ckd_norm), size = 79) # half of rows
ckd_train <- ckd_norm[train_index,]
ckd_test <- ckd_norm[-train_index,]
train_attr <- ckd_train %>%
select(wbcc, bgr)
test_attr <- ckd_test %>%
select(wbcc, bgr)
train_attr <- ckd_train %>%
select(wbcc, bgr)
test_attr <- ckd_test %>%
select(wbcc, bgr)
train_class <- ckd_train %>%
select(class)
test_class <- ckd_test %>%
select(class)
nn3_class <- knn(train = train_attr, test = test_attr, cl = train_class, k = 3)
View(train_attr)
View(train_class)
?knn
typeof(train_class)
unlist(train_class)
train_class <- ckd_train %>%
select(class) %>%
unlist()
nn3_class <- knn(train = train_attr, test = test_attr, cl = train_class, k = 3)
train_class <- ckd_train$class
train_class
nn3_class <- knn(train = train_attr, test = test_attr, cl = train_class, k = 3)
nn3_class
str(nn3_class)
nn3_class <- knn(train = train_attr, test = test_attr, cl = train_class, k = 3)
print(nn3_class)
train <- rbind(iris3[1:25,,1], iris3[1:25,,2], iris3[1:25,,3])
test <- rbind(iris3[26:50,,1], iris3[26:50,,2], iris3[26:50,,3])
cl <- factor(c(rep("s",25), rep("c",25), rep("v",25)))
knn(train, test, cl, k = 3, prob=TRUE)
attributes(.Last.value)
nn3_class <- knn(train = train_attr, test = test_attr, cl = train_class, k = 3)
nn3_class
train_class <- ckd_train$class
test_class <- ckd_test$class
nn3_class <- knn(train = train_attr, test = test_attr, cl = train_class, k = 3)
nn3_class
assess_df <- data.frame(truth = test_class, prediction = nn3_class)
assess_df
?table
table(test_class, nn3_class)
table(test_class, nn3_class)
table(truth = test_class, nn3_class)
table(truth = test_class, prediction = nn3_class)
table(prediction = nn3_class, truth = test_class)
cmat <- table(prediction = nn3_class, truth = test_class)
cmat
diag(cmat)
diag(cmat) / sum(cmat)
diag(cmat) / sum(cmat)
sum(diag(cmat)) / sum(cmat)
(544 +  395)/(544 +  395 + 58 + 135)
(544 +  395)/(544 +  395 + 58 + 153)
?knn
train <- rbind(iris3[,,1], iris3[,,2], iris3[,,3])
cl <- factor(c(rep("s",50), rep("c",50), rep("v",50)))
knn.cv(train, cl, k = 3, prob = TRUE)
train <- rbind(iris3[,,1], iris3[,,2], iris3[,,3])
cl <- factor(c(rep("s",50), rep("c",50), rep("v",50)))
knn.cv(train, cl, k = 3)
library(tidyverse)
library(viridis)
library(class)
library(purrr)
?knn
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
bears <- read.table("bear.txt", header = TRUE)
qplot(headlen, weight, data = bears) +
labs(y = "Weight (pounds)", x = "Head length (inches)")
bear_mod1 <- lm(weight ~ headlen, data = bears)
summary(bear_mod1)
knitr::opts_chunk$set(echo = TRUE)
bear_mod3 <- lm(weight ~ chest + neck, data = bears)
summary(bear_mod3)
new_bears <- data.frame(chest = c(35, 55, 50), neck = c(20, 30, 15))
predict(bear_mod3, newdata = new_bears, se.fit = TRUE)
bear_mod3 <- lm(weight ~ chest + neck, data = bears)
summary(bear_mod3)
-267.065 + 35 * 9.292 + 20 * 5.769
-267.065 + 9.292 * 55 + 5.769 * 30
-267.065 + 9.292 * 50 + 5.769 * 15
10.020 - 0.5051
9.5149/(0.5051 / 18)
